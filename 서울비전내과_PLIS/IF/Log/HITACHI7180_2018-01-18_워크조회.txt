select distinct m.workarea                  , m.accdt AS HOSPDATE                  , m.accseq                             , m.spcyy                              , m.spcno                              , m.ptid AS PID                        , p.수진자명 AS PNAME                  , m.rcvdt                              , m.rcvtm                              , COUNT(r.testcd) AS CNT            from plis..s2lab201 m                      , medichart..TB_인적사항 p                  , plis..s2lab302 r                      , plis..s2lab001 e                  where SUBSTRING(m.accdt,1,8) BETWEEN '20180101' AND '20180118'   and r.testcd IN ('C2200002','C2210002','B2570002','B2580002','B2710002','B2602002','C3720002','C3721002','B2590002','C3711002','C2411002','C2443002','C2420002','C3730002','C3750002','C3780002','B2611002','B2630002','C3795002','C3794002','C2490002','C2510002','C2243002','C4903002','C2500002','C2430002')       and (r.vfydt IS NULL OR r.vfydt='')      and m.ptid = p.챠트번호                    and m.workarea = r.workarea                and m.accdt = r.accdt                      and m.accseq = r.accseq                    and r.testcd = e.testcd                   Group by m.workarea, m.accdt, m.spcyy,m.spcno,m.accseq, m.ptid,p.수진자명,m.rcvdt, m.rcvtm   Order by m.rcvdt, m.rcvtm                
