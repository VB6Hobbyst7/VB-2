SEMILIS 서버
192.167.40.4
MEDIACK
lis
ack

QC서버
192.167.40.4
ACKQC
lis
ack

Select Case gTblNm
Case "H": SQL = SQL & "UPDATE H_RESULT "	'혈액학
Case "C": SQL = SQL & "UPDATE C_RESULT "  '생화학
Case "J": SQL = SQL & "UPDATE J_RESULT "	'수탁
Case "M": SQL = SQL & "UPDATE M_RESULT "	'미생물
Case "S": SQL = SQL & "UPDATE S_RESULT "	'면역학
Case "U": SQL = SQL & "UPDATE U_RESULT "  '뇨화학
End Select
                
--바코드조회

SELECT DISTINCT       M.LABDATE   as HOSPDATE, M.PARTGBN, M.LABSEQ, M.SPECIMENCD
     , M.NAME      as PNAME
     , M.AGE       as AGE
     , M.IDLEFT + M.IDRIGHT AS PJUMIN, M.DEPTCD, M.JUBSUGBN
     , M.MEDICALREMARK as BARCODE
     , M.RESULTENDYN, R.SUBMCD, R.TESTITEMSEQ as ITEM, R.RESULTDATE, R.RESULTTIME, R.ROUTINECD, R.MACHINECD, R.RESULT, R.DELTAGBN, R.REFGBN, R.PANICGBN, R.DELTAMARK, R.REFMARK, R.PANICMARK, R.CMCODE 
  FROM H_JUBSU M, H_RESULT R 

		Select Case gTblNm
        Case "H": SQL = SQL & "  FROM H_JUBSU M, H_RESULT R "	'혈액학
        Case "C": SQL = SQL & "  FROM C_JUBSU M, C_RESULT R " '생화학                    
		    Case "J": SQL = SQL & "  FROM J_JUBSU M, J_RESULT R "	'수탁
        Case "M": SQL = SQL & "  FROM M_JUBSU M, M_RESULT R "	'미생물
        Case "S": SQL = SQL & "  FROM S_JUBSU M, S_RESULT R "	'면역학
        Case "U": SQL = SQL & "  FROM U_JUBSU M, U_RESULT R " '뇨화학
    End Select

 WHERE M.MEDICALREMARK = '바코드'
   AND M.LABDATE       = R.LABDATE 
   AND M.PARTGBN       = R.PARTGBN 
   AND M.LABSEQ        = R.LABSEQ 
   AND M.SPECIMENCD    = R.SPECIMENCD
   And R.TESTITEMSEQ   IN ('C2200','C2210','B2570','B2580','B2602','C3720','B2710','C2443','C3730','C3750','C2411','C3711','C2420','C----','C3780','C2243')
   AND R.CONFIRM       <> 'Y' 


--워크조회

SELECT DISTINCT       M.LABDATE   as HOSPDATE, M.PARTGBN, M.LABSEQ, M.SPECIMENCD
     , M.NAME      as PNAME
     , M.AGE       as AGE
     , M.IDLEFT + M.IDRIGHT AS PJUMIN, M.DEPTCD, M.JUBSUGBN
     , M.MEDICALREMARK as BARCODE
     , M.RESULTENDYN, R.SUBMCD, R.TESTITEMSEQ as ITEM, R.RESULTDATE, R.RESULTTIME, R.ROUTINECD, R.MACHINECD, R.RESULT, R.DELTAGBN, R.REFGBN, R.PANICGBN, R.DELTAMARK, R.REFMARK, R.PANICMARK, R.CMCODE 
		Select Case gTblNm
        Case "H": SQL = SQL & "  FROM H_JUBSU M, H_RESULT R "	'혈액학
        Case "C": SQL = SQL & "  FROM C_JUBSU M, C_RESULT R " '생화학                    
		    Case "J": SQL = SQL & "  FROM J_JUBSU M, J_RESULT R "	'수탁
        Case "M": SQL = SQL & "  FROM M_JUBSU M, M_RESULT R "	'미생물
        Case "S": SQL = SQL & "  FROM S_JUBSU M, S_RESULT R "	'면역학
        Case "U": SQL = SQL & "  FROM U_JUBSU M, U_RESULT R " '뇨화학
    End Select
 WHERE M.LABDATE  BETWEEN '20181017' and '20181017'    
   AND M.LABDATE       = R.LABDATE 
   AND M.PARTGBN       = R.PARTGBN 
   AND M.LABSEQ        = R.LABSEQ 
   AND M.SPECIMENCD    = R.SPECIMENCD
   And R.TESTITEMSEQ   IN ('C2200','C2210','B2570','B2580','B2602','C3720','B2710','C2443','C3730','C3750','C2411','C3711','C2420','C----','C3780','C2243')
   AND R.CONFIRM       <> 'Y' 


-- 결과저장



 SET RESULT = '1.23'
 , MACHINECD = ''
 , RESULTDATE = '20181016'
 , RESULTTIME = '123456'
 WHERE TESTITEMSEQ = '123'
   AND IDLEFT  = '710311'
   AND IDRIGHT = '1010911'
   AND SPECIMENCD = '" & strSpcCd & "'" & vbCr
   AND LABSEQ = '" & strLabSeq & "'" & vbCr
   AND PARTGBN = '" & strPartGbn & "'" & vbCr
   AND LABDATE = '" & strHospDate & "'" & vbCr
   AND CONFIRM <> 'Y' "




select * from C_RESULT
 where LABDATE = '20181016'
   and partgbn = '01'
   and labseq = '00303'
   and specimencd = '002'
union 
select * from C_RESULT
 where LABDATE = '20181016'
   and partgbn = '01'
   and labseq = '00106'
   and specimencd = '002'

LABDATE	PARTGBN	LABSEQ	SPECIMENCD	TESTITEMSEQ	SUBMCD	REGNO	NAME	AGE	IDLEFT	SEX	IDRIGHT	RESULTDATE	RESULTTIME	ROUTINECD	MACHINECD	RESULT	DELTAGBN	REFGBN	PANICGBN	DELTAMARK	REFMARK	PANICMARK	BEFORELABNO	BEFORERESULT	INTERVAL	CMCODE	CONFIRM	CONFIRMID	CONFIRMDATE	CONFIRMTIME	REPORTER	TATGBN	LASTTAT	TATOVERYN	TATERYN	TATOVERTIME	TATOVERGBN	TATREGOK	REPORTER2
20181016	01	00303	002	148	NNNN	00581131	김?28		1		20181017	110935			Negative(0.601)	0	2	0				20171114C0100268	Negative(0.368)	337		Y	노 	20181017	132511		M	1560	Y	N	59	M	N	
20181016	01	00303	002	149	NNNN	00581131	김?28		1		20181017	110935			Negative(5.43)	0	2	0				20171114C0100268	Negative(<2.00)	337		Y	노 	20181017	132511		M	1560	Y	N	59	M	N	
20181016	01	00303	002	157	NNNN	00581131	김?28		1		20181017	110935			Negative(0.036)	0	2	0				20171114C0100268	Negative(0.036)	337		Y	노 	20181017	132511		M	1560	Y	N	59	M	N	
20181016	01	00303	002	217	NNNN	00581131	김?28		1		20181017	100952			Non Reactive(0.0)	0	2	0				20171114C0100268	Non Reactive(0.0)	337		Y	노 	20181017	132511		M	1560	Y	N	59	M	N	
20181016	01	00303	002	231	NNNN	00581131	김?28		1		20181017	110935				0	2	0				20171114C0100268	Negative(5.5)	337								0						
20181016	01	00303	002	235	NNNN	00581131	김?28		1		20181017	110935			Negative(0.176)	0	2	0				20171114C0100268	Negative(0.234)	337		Y	노 	20181017	132511		M	1560	Y	N	59	M	N	

LABDATE	PARTGBN	LABSEQ	SPECIMENCD	TESTITEMSEQ	SUBMCD	REGNO	NAME	AGE	IDLEFT	SEX	IDRIGHT	RESULTDATE	RESULTTIME	ROUTINECD	MACHINECD	RESULT	DELTAGBN	REFGBN	PANICGBN	DELTAMARK	REFMARK	PANICMARK	BEFORELABNO	BEFORERESULT	INTERVAL	CMCODE	CONFIRM	CONFIRMID	CONFIRMDATE	CONFIRMTIME	REPORTER	TATGBN	LASTTAT	TATOVERYN	TATERYN	TATOVERTIME	TATOVERGBN	TATREGOK	REPORTER2
20181016	01	00106	002	056	NNNN	00464480	정?51		2		20181017	112411			88.56	2	2	1						0		Y	노 	20181017	132554		M	1440	Y	N	342	M	N	
20181016	01	00106	002	058	NNNN	00464480	정?51		2		20181017	112411			2.670	2	2	1	D			20170214C0100079	1.250	610		Y	노 	20181017	132554	.	M	1440	Y	N	342	M	N	
20181016	01	00106	002	132	NNNN	00464480	정?51		2		20181017	112411			1.9	2	2	1				20170214C0100079	2.0	610		Y	노 	20181017	132554			0						
20181016	01	00106	002	133	NNNN	00464480	정?51		2		20181017	112411			1.20	2	2	1	D			20170214C0100079	0.75	610		Y	노 	20181017	132554	.		0						
20181016	01	00106	002	134	NNNN	00464480	정?51		2		20181017	112411			13.50	2	2	1				20170214C0100079	12.17	610		Y	노 	20181017	132554			0						
20181016	01	00106	002	135	NNNN	00464480	정?51		2		20181017	112411			13.92	2	2	1				20170214C0100079	11.18	610		Y	노 	20181017	132554			0						
20181016	01	00106	002	148	NNNN	00464480	정?51		2		20181017	112411			Negative(0.580)	0	2	0				20170214C0100079	Negative(0.402)	610		Y	노 	20181017	132554		M	1560	Y	N	222	M	N	
20181016	01	00106	002	149	NNNN	00464480	정?51		2		20181017	112411			Positive(75.83)	0	2	0		P		20170214C0100079	Positive(105.50)	610		Y	노 	20181017	132554		M	1560	Y	N	222	M	N	
20181016	01	00106	002	157	NNNN	00464480	정?51		2		20181017	112411			Negative(0.034)	0	2	0				20170214C0100079	Negative(0.032)	610		Y	노 	20181017	132554		M	1560	Y	N	222	M	N	
20181016	01	00106	002	165	NNNN	00464480	정?51		2		20181017	112411			1.51	2	2	1				20170214C0100079	1.49	610		Y	노 	20181017	132554		M	1440	Y	N	342	M	N	
20181016	01	00106	002	217	NNNN	00464480	정?51		2		20181017	101001			Non Reactive(0.0)	0	2	0				20170214C0100079	Non Reactive(0.2)	610		Y	노 	20181017	132554		M	1560	Y	N	222	M	N	
20181016	01	00106	002	231	NNNN	00464480	정?51		2		20181017	112411				0	2	0						0								0						
20181016	01	00106	002	235	NNNN	00464480	정?51		2		20181017	112411			Negative(0.175)	0	2	0						0		Y	노 	20181017	132554		M	1560	Y	N	222	M	N	

