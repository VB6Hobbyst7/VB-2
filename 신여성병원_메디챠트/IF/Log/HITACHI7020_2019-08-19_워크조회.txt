Select DISTINCT        a.진료년                                                    
     , a.진료월                                                    
     , a.진료일                                                    
     , a.챠트번호                          AS CHARTNO              
     , b.수진자명                          AS PNAME                
     , COUNT(a.처방코드)                   AS CNT                  
  From TB_검사항목 a                                               
     , TB_인적사항 b                                               
     , TB_진료기본 c                                               
 Where a.진료년 BETWEEN '2019' and '2019'  
   And (a.진료월 + a.진료일) BETWEEN '0819' and '0819'
   And a.처방번호 > 0                                              
   And c.진료상태 IN ('1','2','5','6','7','8','9')                     
   And (a.처방코드 + '|' + a.서브코드) IN ('B2570a|','B2570|','B2580a|','B2580|','B2710B|','B2710a|','C2411a|','C2411|','C2443a|','C2443|','C3711P|','C3711ga|004','C3711ga|003','C3711ga|002','C3711ga|001','C3711g|','C3711f|','C3711a|','C3730|','C3720|','C2200|','C2210|','C2420b|','C2420a|','C3750a|','C3750|')     
   And (a.검사결과 IS NULL OR a.검사결과 = '')                     
   And a.진료년    = c.진료년                                      
   And a.진료월    = c.진료월                                      
   And a.진료일    = c.진료일                                      
   And a.챠트번호  = c.챠트번호                                    
   And a.챠트번호  = b.챠트번호                                    
 GROUP BY a.진료년,a.진료월,a.진료일,a.챠트번호,b.수진자명         

