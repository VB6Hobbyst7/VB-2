SELECT DISTINCT        R.RESACPDTE         AS HOSPDATE      , R.RESSPMNUM         AS BARCODE       , R.RESCHTNUM         AS CHARTNO       , P.PBSPATNAM         AS PNAME         , P.PBSRESNUM         AS JUMIN         , R.RESACPNUM                          , R.RESMZHTYP                          , COUNT(R.RESLABCOD)  AS CNT        FROM RESINF R, PBSINF P               WHERE R.RESACPDTE Between '20180717' AND '20180717'              AND R.RESCHTNUM = P.PBSCHTNUM                                          AND R.RESLABCOD IN ('B0030a','B0030b','B0030c','B0030d','B0030e','B0030f','B0030g','B0030h','B0030i','B0030j','B0020a','B0020b','B0020c','B0020d','B0020e','B0020f','B0020g')                                AND (R.RESREPTYP IS NULL OR R.RESREPTYP <> 'F')                        AND (R.RESMZHMNT = ''  OR R.RESMZHMNT = ' '  OR R.RESMZHMNT IS NULL) GROUP BY R.RESACPDTE, R.RESSPMNUM, R.RESCHTNUM, P.PBSPATNAM, P.PBSRESNUM, R.RESACPNUM, R.RESMZHTYP  ORDER BY R.RESACPDTE,R.RESACPNUM, R.RESMZHTYP ASC 
