SELECT Distinct        R.RESACPDTM                 AS HOSPDATE     , R.RESSPMNUM                 AS BARCODE      , R.RESCHTNUM                 AS CHARTNO     , P.PBSPATNAM                 AS PNAME     , COUNT(R.RESLABCOD)          AS CNT            
   FROM RESINF R, PBSINF P 
  WHERE R.RESCHTNUM = P.PBSCHTNUM  
    AND R.RESACPDTE Between '20210107' AND '20210107'
    AND R.RESLABCOD IN ('B1530','B1540a','B1540b','B1540c')
   AND (R.RESREPTYP IS NULL OR R.RESREPTYP <> 'F') 
   AND (R.RESMZHMNT = ''  OR R.RESMZHMNT = ' '  OR R.RESMZHMNT IS NULL)
 GROUP BY R.RESACPDTM, R.RESSPMNUM, R.RESCHTNUM, P.PBSPATNAM  ORDER BY R.RESACPDTM, R.RESSPMNUM, R.RESCHTNUM, P.PBSPATNAM 
