SELECT DISTINCT        CONVERT(NVARCHAR(50),M.접수일자,112)    AS HOSPDATE 
     , M.접수번호                              AS PID      
     , M.차트번호                              AS CHARTNO  
     , M.성명                                  AS PNAME    
     , M.성별                                  AS SEX      
     , M.나이                                  AS AGE      
     , M.거래처명                              AS DEPT     
     , E.검사코드                              AS ITEM     
  FROM VW_검사접수 M, VW_검사결과 R, VW_검사코드 E         
 WHERE M.접수일자      = CONVERT(DATE, '12345678')
   AND M.접수번호      = '90'                
   AND E.학부코드      = 'C1'            
   AND E.검사코드      IN ('D1860','D1850','D1870','D2263','D2611','D2300','D2280','D1840','D1880','D3022','D3022A01','D3022B01','D3022B02','D3022B03','D3022B04')             
   AND ISNULL(R.보고여부, 'N') <> 'Y'                      
   AND (R.결과값 IS NULL OR R.결과값 = '')                 
   AND M.접수일자      = R.접수일자                        
   AND M.접수번호      = R.접수번호                        
   AND R.검사코드      = E.검사코드                        

SELECT DISTINCT        J.접수일자                  AS HOSPDATE                 
     , L.검체번호                  AS BARCODE                  
     , A.챠트번호                  AS CHARTNO                  
     , J.접수번호                  AS PID                      
     , A.환자이름                  AS PNAME                    
     , A.환자성별                  AS SEX                      
     , A.환자나이                  AS AGE                      
     , L.진료검사ID                AS TESTID                   
     , L.진료지원ID                AS SPRTID                   
     , (L.처방코드+ L.서브코드)    AS ITEM                     
  FROM         TB_진료검사 L                                   
   INNER JOIN  TB_진료지원 J ON (L.진료지원ID = J.진료지원ID)  
   INNER JOIN  TB_진료일반 A ON (J.진료일자   = A.진료일자     
                            AND  J.챠트번호   = A.챠트번호     
                            AND  J.진료번호   = A.진료번호)    
 Where L.검체번호 = '1234567890'                       
   AND L.검사상태 < 5                                          
   AND L.처방코드 + L.서브코드 IN ('D1860','D1850','D1870','D2263','D2611','D2300','D2280','D1840','D1880','D3022','D3022A01','D3022B01','D3022B02','D3022B03','D3022B04')         
 ORDER BY J.접수일자, L.검체번호                               

SELECT DISTINCT        J.접수일자                  AS HOSPDATE                 
     , L.검체번호                  AS BARCODE                  
     , A.챠트번호                  AS CHARTNO                  
     , J.접수번호                  AS PID                      
     , A.환자이름                  AS PNAME                    
     , A.환자성별                  AS SEX                      
     , A.환자나이                  AS AGE                      
     , L.진료검사ID                AS TESTID                   
     , L.진료지원ID                AS SPRTID                   
     , (L.처방코드+ L.서브코드)    AS ITEM                     
  FROM         TB_진료검사 L                                   
   INNER JOIN  TB_진료지원 J ON (L.진료지원ID = J.진료지원ID)  
   INNER JOIN  TB_진료일반 A ON (J.진료일자   = A.진료일자     
                            AND  J.챠트번호   = A.챠트번호     
                            AND  J.진료번호   = A.진료번호)    
 Where L.검체번호 = '1234567890'                       
   AND L.검사상태 < 5                                          
   AND L.처방코드 + L.서브코드 IN ('D1860','D1850','D1870','D2263','D2611','D2300','D2280','D1840','D1880','D3022','D3022A01','D3022B01','D3022B02','D3022B03','D3022B04')         
 ORDER BY J.접수일자, L.검체번호                               

SELECT DISTINCT        J.접수일자                  AS HOSPDATE                 
     , L.검체번호                  AS BARCODE                  
     , A.챠트번호                  AS CHARTNO                  
     , J.접수번호                  AS PID                      
     , A.환자이름                  AS PNAME                    
     , A.환자성별                  AS SEX                      
     , A.환자나이                  AS AGE                      
     , L.진료검사ID                AS TESTID                   
     , L.진료지원ID                AS SPRTID                   
     , (L.처방코드+ L.서브코드)    AS ITEM                     
  FROM         TB_진료검사 L                                   
   INNER JOIN  TB_진료지원 J ON (L.진료지원ID = J.진료지원ID)  
   INNER JOIN  TB_진료일반 A ON (J.진료일자   = A.진료일자     
                            AND  J.챠트번호   = A.챠트번호     
                            AND  J.진료번호   = A.진료번호)    
 Where L.검체번호 = '1234567890'                       
   AND L.검사상태 < 5                                          
   AND L.처방코드 + L.서브코드 IN ('D1860','D1850','D1870','D2263','D2611','D2300','D2280','D1840','D1880','D3022','D3022A01','D3022B01','D3022B02','D3022B03','D3022B04')         
 ORDER BY J.접수일자, L.검체번호                               

