SELECT TO_CHAR(SYSDATE,'YYYYMMDD') AS sysdd     , TO_CHAR(SYSDATE,'HH24MISS') AS systm  FROM DUAL

SELECT acptstatcd            From lis.lpjmacpt         WHERE instcd         = ?     AND ptno           = ?     AND acptdd         = ?     AND acptno         = ?     AND acptitemno     = ?     AND testcd         = ?     AND pid            = ?  

select coalesce(lastgenrno+1, 1) as lastgenrno  From lis.lpcmseqn where instcd     = ?    and seqgenryy  = ?    and seqflagcd  = ? 

Update lis.lpcmseqn   set lastgenrno  = ?       ,lastupdtdt  = sysdate      ,lastupdtrid = ?  where instcd      = ?    and seqgenryy   = ?    and seqflagcd   = ? 

update lis.lpcmseqn   Set lastgenrno = 1  where instcd     = ?    and seqgenryy  = '1900'    and seqflagcd  = ? 

INSERT INTO lis.lprmrslt (ptno,       rsltrgstdd,    rsltrgstno,     instcd,         rsltrgsthistno,                                      pid,        rsltrgsttm,    grostestrecdd,  grostestrectm,  grostestrecid,                                      readdd,     readtm,        readid,         extrpartcnts,   extrmthdcnts,                                      diagcnts,   diagcd,                                      spckeepflagcd, rslthideflagcd, conccaseflagcd, preprsltflagcd, ugcyalertflagcd, cnstcd,                                      rsltrgstid, cnclflagcd,    cnclresncd,     cncldd,         cncltm,                                      grospic,    keybloc,       tissbloct,      tissblocnt,     readgrade,                                      cnclid,     delflagcd,     signno,                                      fstrgstdt,  fstrgstrid,                                      lastupdtdt , lastupdtrid, cncrjudgflagcd                                     )            SELECT ptno,       rsltrgstdd,    rsltrgstno,   instcd,                   (SELECT MAX(z.rsltrgsthistno)+1                      FROM lis.lprmrslt z                     WHERE instcd         = ?                       AND ptno           = ?                       AND pid            = ?                   ),                   pid,        rsltrgsttm,    grostestrecdd,  grostestrectm,  grostestrecid,                   readdd,     readtm,        readid,         extrpartcnts,   extrmthdcnts,                   diagcnts,   diagcd,                   spckeepflagcd, rslthideflagcd, conccaseflagcd, preprsltflagcd, ugcyalertflagcd,  cnstcd,                   rsltrgstid, cnclflagcd,    cnclresncd,     cncldd,         cncltm,                   grospic,    keybloc,       tissbloct,      tissblocnt,     readgrade,                   cnclid,     '1',    signno,                   fstrgstdt,  fstrgstrid,                   lastupdtdt , lastupdtrid, cncrjudgflagcd              From lis.lprmrslt             WHERE instcd         = ?               AND ptno           = ?               AND pid            = ?               AND rsltrgsthistno = 1               AND delflagcd      = '0'

Delete From lis.lprmrslt              WHERE instcd         = ?               AND ptno           = ?               AND pid            = ?               AND rsltrgsthistno = 1               AND delflagcd      = '0'

insert into lis.lprmrslt (ptno,          rsltrgstdd,     rsltrgstno,     rsltrgsthistno, instcd,                                 pid,           rsltrgsttm,     grostestrecdd,  grostestrectm,  grostestrecid,                          diagcnts,                                                                                              readdd,        readtm,         readid,         extrpartcnts,   extrmthdcnts,   diagcd,                 spckeepflagcd, rslthideflagcd, cncrjudgflagcd, conccaseflagcd, preprsltflagcd, ugcyalertflagcd, cnstcd,rsltrgstid,    cnclflagcd,     cnclresncd,     cncldd,         cncltm,                                 grospic,       keybloc,        tissbloct,      tissblocnt,     readgrade,                              cnclid,        delflagcd,                                                                              fstrgstdt,     fstrgstrid,                                                                             lastupdtdt,    lastupdtrid)                                                                             values (?, ?, ?, 1, ?,?, ?, ?, ?, ?,?,?, ?, ?, ?, ?, ?,?, ?, ?, ?, ?, ?, ?,CASE WHEN ? IS NULL THEN ? ELSE ? END ,       '-',       '-',       '-',       '-',?, ?, ?, ?, ?,'-',   '0',sysdate,  case when ? is null then ? else ? end ,sysdate,  case when ? is null then ? else ? end )

INSERT INTO lis.lprmcnts (ptno,       rsltrgstdd, rsltrgstno, rsltrgsthistno, instcd, pid,                          rsltcnts1,  rsltcnts2,  rsltcnts3,                          rsltcnts4,  rsltcnts5,  rsltcnts6,                          cmtcnts,    delflagcd,                          fstrgstdt,              fstrgstrid,                          lastupdtdt,             lastupdtrid)SELECT ptno,       rsltrgstdd, rsltrgstno,       (SELECT MAX(z.rsltrgsthistno)+1          FROM lis.lprmcnts z         WHERE instcd         = ?           AND ptno           = ?           AND pid            = ?       ),       instcd,     pid,       rsltcnts1,  rsltcnts2,  rsltcnts3,       rsltcnts4,  rsltcnts5,  rsltcnts6,       cmtcnts,    '1',       fstrgstdt,              fstrgstrid,       lastupdtdt , lastupdtrid  From lis.lprmcnts WHERE instcd         = ?   AND ptno           = ?   AND pid            = ?   AND rsltrgsthistno = 1   AND delflagcd      = '0'

Delete From lis.lprmcnts WHERE instcd         = ?   AND ptno           = ?   AND pid            = ?   AND rsltrgsthistno = 1   AND delflagcd      = '0'

insert into lis.lprmcnts (ptno,       rsltrgstdd, rsltrgstno, rsltrgsthistno, instcd, pid,rsltcnts1,  rsltcnts2,  rsltcnts3,rsltcnts4,  rsltcnts5,  rsltcnts6,cmtcnts,    delflagcd,fstrgstdt,  fstrgstrid,lastupdtdt, lastupdtrid) values (?, ?, ?, 1, ?, ?,?, ?, ?,?, ?, ?,?,'0',sysdate, ?,sysdate, ?)

Update lis.lprmrslt   set readdd          = ?       ,readtm          = ?       ,readid          = ?       ,cnclflagcd      = '-'       ,cnclresncd      = '-'       ,cncldd          = '-'       ,cncltm          = '-'       ,cnclid          = '-'       ,ugcyalertflagcd = ?       ,lastupdtdt      = sysdate      , lastupdtrid     = ?  where instcd          = ?    and ptno            = ?    and pid             = ?    and rsltrgsthistno  = 1    and delflagcd       = '0'

Update lis.lpcmpnis   set extrpartcnts = ? ,       extrmthdcnts = ? ,       diagcnts     = ? ,       diagcd       = ? ,       lastupdtdt   = sysdate,       lastupdtrid  = ?  where instcd       = ?    and ptno         = ?    and delflagcd    = '0'

Update lis.lpjmacpt   set rsltstatcd  = nvl(?, 'Y')     , lastupdtrid = ?      , lastupdtdt  = sysdate where instcd      = ?    and ptno        = ?    and pid         = ?    and acptdd      = nvl(? , acptdd)

SELECT acpt.instcd, acpt.prcpdd, acpt.pid, acpt.prcpno, acpt.execprcpuniqno,       MIN(acpt.prcpgenrflag) AS prcpgenrflag,  'I' AS biztretflagcd,       Case WHEN ''||53||'' = '32' THEN '700'            WHEN ''||53||'' = '52' THEN '740'            WHEN ''||53||'' = '53' THEN '700'       END AS newprcpstatcd,       Case WHEN ''||53||'' = '32' THEN '700'            WHEN ''||53||'' = '52' THEN '740'            WHEN ''||53||'' = '53' THEN '700'       END AS bizflagcd,       Case WHEN ''||53||'' = '32' THEN '700'            WHEN ''||53||'' = '52' THEN '740'            WHEN ''||53||'' = '53' THEN '700'       END AS tretflagcd,       CASE WHEN 53 = '32' THEN MAX(pnis.makeenddd) ELSE TO_CHAR(SYSDATE,'YYYYMMDD') END AS tretdd,       CASE WHEN 53 = '32' THEN MAX(pnis.makeendtm) ELSE TO_CHAR(SYSDATE,'HH24MISS') END AS trettm,       53 AS scrno     , acpt.prcpgenrflag AS prcpgenrflagcd  FROM lis.lpjmacpt acpt     , lis.lpcmpnis pnis WHERE acpt.instcd      = ?   AND acpt.ptno        = ?   AND acpt.pid         = ?   AND acpt.acptstatcd IN ('0', '2', '3', '4', '9')   AND acpt.instcd      = pnis.instcd   AND acpt.ptno        = pnis.ptno   AND pnis.delflagcd   = '0'   AND acpt.acptstatcd  = ?  GROUP BY acpt.instcd, acpt.prcpdd, acpt.pid, acpt.prcpno,          acpt.execprcpuniqno , acpt.prcpgenrflag

select prcpstatcd  from (       SELECT b.prcpstatcd         FROM emr.mmodexip a, emr.mmohiprc b         WHERE a.instcd         = ?           AND a.pid            = ?           AND a.prcpdd         = ?           AND a.execprcpuniqno = ?           AND a.execprcphistcd = 'O'          AND a.instcd         = b.instcd          AND a.pid            = b.pid          AND a.prcpdd         = b.prcpdd          AND a.prcpno         = b.prcpno          AND a.prcphistno     = b.prcphistno          AND b.prcphistcd     = 'O'          AND b.prcpclscd      = 'D2'          AND b.tempprcpflag   = 'N'        Union All       SELECT b.prcpstatcd         FROM emr.mmodexop a, emr.mmohoprc b         WHERE a.instcd         = ?           AND a.pid            = ?           AND a.prcpdd         = ?           AND a.execprcpuniqno = ?           AND a.execprcphistcd = 'O'          AND a.instcd         = b.instcd          AND a.pid            = b.pid          AND a.prcpdd         = b.prcpdd          AND a.prcpno         = b.prcpno          AND a.prcphistno     = b.prcphistno          AND b.prcphistcd     = 'O'          AND b.prcpclscd      = 'D2'          AND b.tempprcpflag   = 'N' ) Where rownum = 1

Update emr.mmohiprc   SET prcpstatcd  = ? ,       lastupdtdt  = SYSDATE,       lastupdtrid = ?  WHERE (instcd, pid, prcpdd, prcpno, prcphistno) IN       (SELECT instcd, pid, prcpdd, prcpno, prcphistno          From emr.mmodexip         WHERE instcd         = ?            AND pid            = ?            AND prcpdd         = ?            AND execprcpuniqno = ?            AND execprcphistcd = 'O'       )   AND prcphistcd   = 'O'   AND prcpclscd    = 'D2'   AND tempprcpflag = 'N'

Update emr.mmodexip a  SET a.execprcpstatcd = ?      ,a.lastupdtdt     = SYSDATE      ,a.lastupdtrid    = ? WHERE a.instcd         = ?   AND a.pid            = ?   AND a.prcpdd         = ?   AND a.execprcpuniqno = ?   AND a.execprcphistcd = 'O'

SELECT COUNT(prcpdd) AS tretcnt  From emr.mmodexpt WHERE instcd         = ?    AND execprcpuniqno = ?    AND prcpdd         = ?    AND tretflagcd     = ? 

INSERT INTO emr.mmodexpt (prcpdd,       execprcpuniqno,tretflagcd,   instcd,tretdd,       trettm,    tretpsnid, fstrgstrid,   fstrgstdt,lastupdtrid,  lastupdtdt)VALUES ( ?,  CAST(? AS INTEGER), ?,  ?, ?,  ?,  CASE WHEN ? IS NULL THEN ? ELSE ? END,  ?,   SYSDATE, ?,   SYSDATE)

INSERT INTO lis.lprmtrlt       (ptno,       rsltrgstdd, rsltrgstno, rsltrgsthistno, riskflagcd, instcd,        acptdd,     acptno,     testcd,     acptitemno,     testrslt,  testrsltxml,  testrsltetc,  delflagcd,        fstrgstdt,  fstrgstrid,        lastupdtdt, lastupdtrid) SELECT ptno,       rsltrgstdd, rsltrgstno,        (SELECT MAX(z.rsltrgsthistno)+1 FROM lis.lprmtrlt z          WHERE z.instcd     = ?            AND z.ptno       = ?            AND z.rsltrgstdd = ?            AND z.rsltrgstno = CAST(? AS DECIMAL(12,0))            AND z.riskflagcd = ?        ),        riskflagcd, instcd,        acptdd,     acptno,     testcd,     acptitemno, decode(nvl(?,'IN'),'SMLPU00700',?,testrslt), testrsltxml,  testrsltetc,  '1',        fstrgstdt,  fstrgstrid,        SYSDATE,  ''||?||''   From lis.lprmtrlt  WHERE instcd         = ?    AND ptno           = ?    AND rsltrgstdd     = ?    AND rsltrgstno     = CAST(? AS DECIMAL(12,0))    AND riskflagcd     = ?    AND testcd         = ?    AND rsltrgsthistno = 1

DELETE FROM lis.lprmtrlt WHERE instcd         = ?   AND ptno           = ?   AND rsltrgstdd     = ?   AND rsltrgstno     = CAST(? AS DECIMAL(12,0))   AND rsltrgsthistno = 1   AND riskflagcd     = ?   AND testcd         = ?

INSERT INTO lis.lprmtrlt       (ptno,         rsltrgstdd,      rsltrgstno,           rsltrgsthistno,       riskflagcd,    instcd,       acptdd,        acptno,          testcd,       acptitemno,    testrslt,        testrsltxml,  testrsltetc, delflagcd,       fstrgstdt,     fstrgstrid,       lastupdtdt,    lastupdtrid)VALUES (?,  ?, CAST(? AS DECIMAL(12,0)), 1,        ?,  ?,        ?,  CAST(? AS DECIMAL(12,0)),   ?,        CAST(? AS SMALLINT),  ?,     ?  , ?  ,   '0',        SYSDATE, ?,        SYSDATE, ?)

INSERT INTO lis.lprmtrlt       (ptno,         rsltrgstdd,      rsltrgstno,           rsltrgsthistno,       riskflagcd,    instcd,       acptdd,        acptno,          testcd,       acptitemno,    testrslt,        testrsltxml,  testrsltetc, delflagcd,       fstrgstdt,     fstrgstrid,       lastupdtdt,    lastupdtrid)VALUES (?,  ?, CAST(? AS DECIMAL(12,0)), 1,        ?,  ?,        ?,  CAST(? AS DECIMAL(12,0)),   ?,        CAST(? AS SMALLINT),  ?,     ?  , ?  ,   '0',        SYSDATE, ?,        SYSDATE, ?)ptno:M17003236rsltrgstdd:20170920rsltrgstno:32819riskflagcd:9instcd:017acptdd:20170920acptno:34038testcd:PMO12040acptitemno:1testrslt:[Methods]                                                                                               Seegene HPV Real-Time PCR (Anyplex II HPV 28 Detection Real-time PCR)                                   [Result]                                                                                                123456789012345678901234567890123456789012345678901234567890testrsltxml:testrsltetc:fstrgstrid:20801950lastupdtrid:20801950

SELECT acptstatcd            From lis.lpjmacpt         WHERE instcd         = ?     AND ptno           = ?     AND acptdd         = ?     AND acptno         = ?     AND acptitemno     = ?     AND testcd         = ?     AND pid            = ?     AND prcpdd         = ?     AND execprcpuniqno = ?  

Update lis.lpjmacpt    SET acptstatcd  = ?,        lastupdtdt  = SYSDATE,        lastupdtrid = ?  WHERE instcd         = ?    AND ptno           = ?    AND acptdd         = ?    AND acptno         = CAST(? AS DECIMAL(12,0))    AND acptitemno     = CAST(? AS SMALLINT)    AND testcd         = ?    AND pid            = ?    AND prcpdd         = ?    AND execprcpuniqno = CAST(? AS INTEGER)

