SELECT DISTINCT        SUBSTRING(O.OCMACPDTM,1,8)  AS HOSPDATE      , R.RESOCMNUM                 AS BARCODE       , O.OCMCHTNUM                 AS CHARTNO       , R.RESOCMNUM                 AS PID           , P.PBSPATNAM                 AS PNAME         , P.PBSSEXTYP                 AS SEX           ,COUNT(R.RESLABCOD)           AS CNT         FROM DRBITPACK..RESINF AS R, DRBITPACK..OCMINF AS O, DRBITPACK..PBSINF AS P, DRBITPACK..LABMST AS E, DRBITPACK..ODRINF AS W WHERE O.OCMACPDTM BETWEEN '20190118000000' AND '20190118235959'   AND O.OCMCOMSTT NOT IN ('CN', 'CR', 'VC')          AND R.RESLABCOD IN ('C2200','C2210','C3720','C3721','C2411','B2570','got','B2580','gpt','B2602','B2710','gtp','bun','C3730','C3750','C3770','cr','C3780','URIC','uricacid','C3711','fbs','Glucose','amy','amy1','amylase','B2611','C2443','tg','C2420','hdl','ldl')            AND R.RESOCMNUM = O.OCMNUM                         AND O.OCMCHTNUM = P.PBSCHTNUM                      AND R.RESOCMNUM = W.ODROCMNUM                      AND R.RESLABCOD = E.LABCOD                         AND (R.RESREPTYP IS NULL OR R.RESREPTYP <> 'F')    AND W.ODRDELFLG = 'N'                              AND (R.RESRLTVAL = ''  OR R.RESRLTVAL IS NULL)   GROUP BY O.OCMACPDTM,R.RESOCMNUM,O.OCMCHTNUM,R.RESOCMNUM,P.PBSPATNAM,P.PBSSEXTYP       ORDER BY HOSPDATE, BARCODE, CHARTNO, PID
