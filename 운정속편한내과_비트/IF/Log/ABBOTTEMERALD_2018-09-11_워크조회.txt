SELECT DISTINCT        SUBSTRING(O.OCMACPDTM,1,8)  AS HOSPDATE      , R.RESOCMNUM                 AS BARCODE       , O.OCMCHTNUM                 AS CHARTNO       , R.RESOCMNUM                 AS PID           , P.PBSPATNAM                 AS PNAME         , P.PBSSEXTYP                 AS SEX           ,COUNT(R.RESLABCOD)           AS CNT         FROM DRBITPACK..RESINF AS R, DRBITPACK..OCMINF AS O, DRBITPACK..PBSINF AS P, DRBITPACK..LABMST AS E, DRBITPACK..ODRINF AS W WHERE O.OCMACPDTM BETWEEN '20180910000000' AND '20180911235959'   AND O.OCMCOMSTT NOT IN ('CN', 'CR', 'VC')          AND R.RESLABCOD IN ('L22','L23','B1010','L24','L25','B1020A','B1020B','B1020C','B1220','L26','B1060A','B1230','B1060B','B1091A','B1091B','B1091C')            AND R.RESOCMNUM = O.OCMNUM                         AND O.OCMCHTNUM = P.PBSCHTNUM                      AND R.RESOCMNUM = W.ODROCMNUM                      AND R.RESLABCOD = E.LABCOD                         AND (R.RESREPTYP IS NULL OR R.RESREPTYP <> 'F')    AND W.ODRDELFLG = 'N'                              AND (R.RESRLTVAL = ''  OR R.RESRLTVAL IS NULL)   GROUP BY O.OCMACPDTM,R.RESOCMNUM,O.OCMCHTNUM,R.RESOCMNUM,P.PBSPATNAM,P.PBSSEXTYP       ORDER BY HOSPDATE, BARCODE, CHARTNO, PID
