SELECT DISTINCT        SUBSTRING(O.OCMACPDTM,1,8)  AS HOSPDATE      , R.RESOCMNUM                 AS BARCODE       , O.OCMCHTNUM                 AS CHARTNO       , R.RESOCMNUM                 AS PID           , P.PBSPATNAM                 AS PNAME         , P.PBSSEXTYP                 AS SEX           ,COUNT(R.RESLABCOD)           AS CNT         FROM DRBITPACK..RESINF AS R, DRBITPACK..OCMINF AS O, DRBITPACK..PBSINF AS P, DRBITPACK..LABMST AS E, DRBITPACK..ODRINF AS W WHERE O.OCMACPDTM BETWEEN '20190118000000' AND '20190118235959'   AND O.OCMCOMSTT NOT IN ('CN', 'CR', 'VC')          AND R.RESLABCOD IN ('B1050','B1040','B1010','hb','B1020','hct','B1020A','mcv','B1020B','mch','B1020C','mchc','B1220','rdw','B1060','plt','B1060B','mpv','B1230','pct','pdw','lymph','mono','B1091','neut')            AND R.RESOCMNUM = O.OCMNUM                         AND O.OCMCHTNUM = P.PBSCHTNUM                      AND R.RESOCMNUM = W.ODROCMNUM                      AND R.RESLABCOD = E.LABCOD                         AND (R.RESREPTYP IS NULL OR R.RESREPTYP <> 'F')    AND W.ODRDELFLG = 'N'                              AND (R.RESRLTVAL = ''  OR R.RESRLTVAL IS NULL)   GROUP BY O.OCMACPDTM,R.RESOCMNUM,O.OCMCHTNUM,R.RESOCMNUM,P.PBSPATNAM,P.PBSSEXTYP       ORDER BY HOSPDATE, BARCODE, CHARTNO, PID
