SELECT DISTINCT         SUBSTRING(R.RESACPDTM,1,8) AS HOSPDATE                 
     , R.RESSPMNUM                 AS BARCODE                  
     , R.RESCHTNUM                 AS CHARTNO                  
     , P.PBSPATNAM                 AS PNAME                    
     , COUNT(R.RESLABCOD)          AS CNT                      
  FROM RESINF AS R                                             
WHERE O.OCMACPDTM BETWEEN '20190927' AND '20190927'    
  AND R.RESCHTNUM = P.PBSCHTNUM                                
  AND R.RESLABCOD IN ('TEST_A','TEST_B','VB6012A')                      
  AND (R.RESREPTYP IS NULL OR R.RESREPTYP <> 'F')              
  AND (R.RESRLTVAL = ''  OR R.RESRLTVAL IS NULL)               
 GROUP BY R.RESACPDTM,R.RESSPMNUM,R.RESCHTNUM,P.PBSPATNAM      

