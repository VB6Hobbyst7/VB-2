SELECT DISTINCT        a.RECEIPTDATE    AS HOSPDATE      , a.SPECIMENNUM    AS BARCODE       , a.RECEIPTNO      AS CHARTNO       , a.IPDOPD         AS INOUT         , a.PTNO           AS PID           , a.SNAME          AS PNAME         , COUNT(a.LABCODE) AS CNT         FROM SLA_LabMaster a, SLA_LabResult b    WHERE a.RECEIPTNO     = b.RECEIPTNO          AND a.ORDERCODE     = b.ORDERCODE          and a.RECEIPTDATE   = b.RECEIPTDATE        AND a.SPECIMENNUM   = b.SPECIMENNUM        AND a.RECEIPTDATE BETWEEN '2018-09-05' and '2018-09-05'   AND b.LABCODE IN ('B2570','B2570P','B2580','B2580P','C2200','C2200F','C2200P','TPALB1','C2210','TPALB2','100GTT','50GTT','C3711','C3711A','C3711P','F6932','B2710','B2710P','C3720','C3720P','C3721','DBIL','BUNCR1','C3730','BUNCR2','C3750','C3750P','C2411','C2411P','C2443','C2443P','C2420','C2420P','C2430','C3780','B2611','C2243','C4901','C4903','B2602','C2430S')      AND a.JSTATUS < '3'                        AND (b.Result = '' OR LTRIM(RTRIM(b.Result)) IS NULL) GROUP BY a.RECEIPTDATE, a.SPECIMENNUM, a.RECEIPTNO, a.IPDOPD, a.PTNO, a.SNAME  ORDER BY a.RECEIPTDATE,a.SPECIMENNUM 
