SELECT /*+ leading(acpt) */   ACPT.INSTCD , ACPT.ACPTDD AS HOSPDATE, ACPT.ACPTNO AS BARCODE, ACPT.ACPTITEMNO AS SEQ, ACPT.ptno AS CHARTNO, ACPT.pid AS PID, ACPT.testcd AS ITEM, ACPT.prcpgenrflag AS INOUT, ACPT.ORDDEPTCD AS RACKNO, DEPT.deptengabbr AS POSNO, ACPT.PRCPDD AS KEY1, ACPT.EXECPRCPUNIQNO AS KEY2, ACPT.prcpno AS JUMIN, PTBS.hngnm AS PNAME, PTBS.SEX AS SEX, PTBS.BRTHDD AS DOB, com.fn_zz_getage(ptbs.rrgstno1, ptbs.rrgstno2, acpt.acptdd, 'A', ptbs.brthdd) as AGE, ( SELECT min(rslt.rsltrgstno)    FROM lis.lprmrslt rslt   Where ACPT.instcd = rslt.instcd     AND ACPT.ptno   = rslt.ptno     AND ACPT.pid    = rslt.pid     AND rslt.delflagcd = '0'     AND rslt.rsltrgsthistno = 1) as rsltrgstno  FROM lis.lpjmacpt ACPT, lis.lpcmtest TEST, lis.lpcmspcm SPCM, pam.pmcmptbs PTBS, com.zsdddept DEPT WHERE ACPT.instcd= ?    AND ACPT.ptno = ?    AND ACPT.testcd IN (?)    AND ACPT.instcd          = TEST.instcd   AND ACPT.testcd          = TEST.testcd   AND ACPT.instcd          = SPCM.instcd   AND ACPT.spccd           = SPCM.spccd   AND ACPT.instcd          = PTBS.instcd   AND ACPT.pid             = PTBS.pid   AND ACPT.instcd          = DEPT.instcd   AND ACPT.orddeptcd       = DEPT.deptcd   AND ACPT.prcpdd BETWEEN DEPT.valifromdd AND DEPT.valitodd

